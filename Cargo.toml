[workspace]
default-members = ["ark/cli"]
members = [
    # "ipwis-binding",
    "ark/api",
    "ark/cli",
    "ark/controller",
    "ark/core",
    "ark/core/k8s",
    "ark/gateway",
    "ark/provider/api",
    "ark/provider/kubernetes",
    "ark/provider/local",
    "dash/api",
    "dash/cli",
    "dash/client",
    "dash/controller",
    "dash/gateway",
    "dash/openapi",
    "dash/provider",
    "dash/provider/api",
    "dash/router",
    "kiss/ansible",
    "kiss/api",
    "kiss/assets",
    "kiss/controller",
    "kiss/gateway",
    "kiss/manager",
    "kiss/monitor",
    "netai/api",
    "netai/client",
    "netai/endpoint",          # exclude(alpine)
    "netai/solver",            # exclude(alpine)
    "proxyx/api",              # exclude(alpine)
    "proxyx/cli",              # exclude(alpine)
    "proxyx/storage/influxdb", # exclude(alpine)
    "vine/api",
    "vine/bastion",
    "vine/controller",
    "vine/rbac",
    "vine/session",
]

[workspace.dependencies]
actix-cors = { version = "0.6" }
actix-multipart = { version = "0.6", features = ["derive", "tempfile"] }
actix-web = { version = "4.3", default-features = false, features = [
    "macros",
    "rustls",
] }
actix-web-lab = { version = "0.19" }
anyhow = { version = "1.0", features = ["backtrace"] }
async-recursion = { version = "1.0" }
async-trait = { version = "0.1" }
base64 = { version = "0.21" }
bytes = { version = "1.4" }
chatgpt = { package = "chatgpt_rs", version = "1.1" }
chrono = { version = "0.4", features = ["serde"] }
clap = { version = "4.1", features = ["env", "derive"] }
ctrlc = { version = "3.2" }
email_address = { version = "0.2" }
futures = { version = "0.3" }
gethostname = { version = "0.4" }
half = { version = "2.2" }
http-cache-reqwest = { version = "0.9", features = ["manager-cacache"] }
image = { version = "0.24" }
inflector = { package = "Inflector", version = "0.11" }
influxdb2 = { version = "0.3", default-features = false, features = ["rustls"] }
influxdb2-derive = { version = "0.1" }
influxdb2-structmap = { version = "0.2" }
ipnet = { version = "2.7", features = ["schemars", "serde"] }
itertools = { version = "0.10" }
k8s-openapi = { version = "0.18", features = ["schemars", "v1_26"] }
kube = { version = "0.82", default-features = false }
language-tags = { version = "0.3", features = ["serde"] }
log = { version = "0.4" }
mime = { version = "0.3" }
ndarray = { version = "0.15", features = ["serde"] }
num-traits = { version = "0.2" }
octocrab = { git = "https://github.com/ulagbulag/octocrab", default-features = false, features = [
    "rustls-tls",
] }
ort = { version = "1.14", default-features = false, features = [
    # Common
    "copy-dylibs",
    "download-binaries",
    "half",
    # "load-dynamic",
    # NOTE: external providers are supported by python packages in a container
    "cuda",
    "tensorrt",
] }
paste = { version = "1.0" }
pretty_env_logger = { version = "0.4" }
regex = { version = "1.7" }
reqwest = { version = "0.11", default-features = false, features = [
    "json",
    "rustls-tls",
    "stream",
] }
reqwest-middleware = "0.2"
rust-tokenizers = { package = "rust_tokenizers", version = "8.0" }
schemars = { version = "0.8", features = ["chrono", "derive", "uuid1"] }
sea-orm = { version = "0.11", features = [
    "macros",
    "runtime-tokio-rustls",
    "sqlx-postgres",
    "with-chrono",
    "with-json",
    "with-time",
    "with-uuid",
] }
semver = { version = "1.0" }
serde = { version = "1.0", features = ["derive"] }
serde_json = { version = "1.0" }
serde_yaml = { version = "0.9" }
sha2 = { version = "0.10" }
strum = { version = "0.24", features = ["derive"] }
tera = { version = "1.18" }
tokio = { version = "1.28", features = ["macros", "rt"] }
url = { version = "2.3", features = ["serde"] }
uuid = { version = "1.2", features = ["js", "serde", "v4"] }
which = { version = "4.4" }

[patch.crates-io]
# Fixes a bug in building with musl binary (i.e. Alpine Linux)
# see: https://github.com/pkolaczk/fclones/issues/95#issuecomment-987375929
reflink = { git = "https://github.com/nicokoch/reflink.git", rev = "e8d93b465f5d9ad340cd052b64bbc77b8ee107e2" }
