---
- name: Populate service facts
  service_facts:

- name: Check whether systemd-networkd is running
  assert:
    that: ansible_facts.services["systemd-networkd.service"].state == "running"

- name: Provision NICs
  include: network-adaptor.yaml

- name: Provision Ethernet Interfaces
  include: network-ethernet.yaml

- name: Restart systemd-networkd
  when: interface_primary is defined
  systemd:
    name: systemd-networkd.service
    state: restarted
    daemon_reload: true
