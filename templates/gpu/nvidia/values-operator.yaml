---
# standalone dcgm hostengine
dcgm:
  # disabled by default to use embedded nv-hostengine by exporter
  enabled: false

dcgmExporter:
  enabled: true

driver:
  # Flatcar Container Linux should need some patches for driver installer
  repository: quay.io/ulagbulag
  image: openark-gpu-nvidia-driver
  enabled: false

devicePlugin:
  enabled: true

gds:
  enabled: false

gfd:
  enabled: true

kataManager:
  enabled: false

migManager:
  enabled: true

nodeStatusExporter:
  enabled: true

operator:
  affinity:
    nodeAffinity:
      # KISS ephemeral control plane nodes should be excluded
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: node-role.kubernetes.io/kiss
                operator: In
                values:
                  - ControlPlane
          - matchExpressions:
              - key: node-role.kubernetes.io/kiss-ephemeral-control-plane
                operator: DoesNotExist
  defaultRuntime: containerd
  # upgrade CRD on chart upgrade, requires --disable-openapi-validation flag
  # to be passed during helm upgrade.
  upgradeCRD: true

sandboxDevicePlugin:
  enabled: false

toolkit:
  enabled: true
  # Flatcar Container Linux has no write access to /usr directory
  installDir: /opt/nvidia-runtime

validator:
  # NOTE: NVIDIA gpu-operator bug when using pre-installed driver
  # SEE: https://github.com/NVIDIA/gpu-operator/issues/569
  driver:
    env:
      - name: DISABLE_DEV_CHAR_SYMLINK_CREATION
        value: "true"

vgpuManager:
  enabled: false
